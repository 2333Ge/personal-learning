<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"/>
    <title>ã€ŠMastering Gradleã€‹ç¬”è®° | 2333Ge</title>
    <link rel="shortcut icon" href="/logo.jpg"/>
    <meta name="generator" content="VuePress 1.9.7"/>
    
    <meta name="description" content="ä¸€ä¸ª95åç¨‹åºçŒ¿çš„å­¦ä¹ å°ç«™">
    
    <link rel="preload" href="/assets/css/0.styles.1ee3eca2.css" as="style"><link rel="preload" href="/assets/js/app.68bfad1c.js" as="script"><link rel="preload" href="/assets/js/4.2437bced.js" as="script"><link rel="preload" href="/assets/js/12.a478910c.js" as="script"><link rel="preload" href="/assets/js/49.11a361e1.js" as="script"><link rel="prefetch" href="/assets/js/10.f141d789.js"><link rel="prefetch" href="/assets/js/11.00a60c3a.js"><link rel="prefetch" href="/assets/js/13.ce5c32bf.js"><link rel="prefetch" href="/assets/js/14.9acd195f.js"><link rel="prefetch" href="/assets/js/15.16b5b255.js"><link rel="prefetch" href="/assets/js/16.d87d9005.js"><link rel="prefetch" href="/assets/js/17.042f8acd.js"><link rel="prefetch" href="/assets/js/18.4c520c25.js"><link rel="prefetch" href="/assets/js/19.b9229b8f.js"><link rel="prefetch" href="/assets/js/20.17dd5352.js"><link rel="prefetch" href="/assets/js/21.b2688e48.js"><link rel="prefetch" href="/assets/js/22.9d26159f.js"><link rel="prefetch" href="/assets/js/23.05434dfc.js"><link rel="prefetch" href="/assets/js/24.8f23bc95.js"><link rel="prefetch" href="/assets/js/25.211f512c.js"><link rel="prefetch" href="/assets/js/26.06a120e6.js"><link rel="prefetch" href="/assets/js/27.6583eb90.js"><link rel="prefetch" href="/assets/js/28.d6a25868.js"><link rel="prefetch" href="/assets/js/29.4697b4c0.js"><link rel="prefetch" href="/assets/js/30.d5b42300.js"><link rel="prefetch" href="/assets/js/31.ede60d91.js"><link rel="prefetch" href="/assets/js/32.1f972781.js"><link rel="prefetch" href="/assets/js/33.13fcf23d.js"><link rel="prefetch" href="/assets/js/34.314509ec.js"><link rel="prefetch" href="/assets/js/35.23a7e742.js"><link rel="prefetch" href="/assets/js/36.96478799.js"><link rel="prefetch" href="/assets/js/37.3b220328.js"><link rel="prefetch" href="/assets/js/38.4cf0640b.js"><link rel="prefetch" href="/assets/js/39.529baff6.js"><link rel="prefetch" href="/assets/js/40.a0e7d7e8.js"><link rel="prefetch" href="/assets/js/41.782592f7.js"><link rel="prefetch" href="/assets/js/42.c7594c7e.js"><link rel="prefetch" href="/assets/js/43.7db302a1.js"><link rel="prefetch" href="/assets/js/44.a91c666c.js"><link rel="prefetch" href="/assets/js/45.264c1125.js"><link rel="prefetch" href="/assets/js/46.c0fc0ad0.js"><link rel="prefetch" href="/assets/js/47.e230b743.js"><link rel="prefetch" href="/assets/js/48.b39aacfa.js"><link rel="prefetch" href="/assets/js/5.f70a999f.js"><link rel="prefetch" href="/assets/js/50.af2d54f6.js"><link rel="prefetch" href="/assets/js/51.5a29cf90.js"><link rel="prefetch" href="/assets/js/52.44440ad4.js"><link rel="prefetch" href="/assets/js/53.2a9cb852.js"><link rel="prefetch" href="/assets/js/54.891544fe.js"><link rel="prefetch" href="/assets/js/55.c16a935c.js"><link rel="prefetch" href="/assets/js/56.84e19f1f.js"><link rel="prefetch" href="/assets/js/57.56206fc3.js"><link rel="prefetch" href="/assets/js/6.a3ae652f.js"><link rel="prefetch" href="/assets/js/7.5627ef7d.js"><link rel="prefetch" href="/assets/js/8.bbd002bd.js"><link rel="prefetch" href="/assets/js/9.0731487e.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.b9a9f3ba.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.2864cecd.js">
    <link rel="stylesheet" href="/assets/css/0.styles.1ee3eca2.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><div class="theme-sidebar"><div class="theme-sidebar__inner"><div class="theme-header"><a href="/" class="theme-header__logo router-link-active"><img draggable="false" src="/logo.jpg" alt="logo" width="160" height="160" class="theme-header__picture"> <div class="theme-palette"><span class="theme-palette__emoji"><svg class="theme-icon theme-icon-palette"><use xlink:href="#theme-icon-palette"></use></svg></span> <div class="theme-palette__list"><a href="javascript:;" title="#673ab7" style="color:#673ab7;"></a><a href="javascript:;" title="#3f51b5" style="color:#3f51b5;"></a><a href="javascript:;" title="#2196f3" style="color:#2196f3;"></a><a href="javascript:;" title="#009688" style="color:#009688;"></a><a href="javascript:;" title="#4caf50" style="color:#4caf50;"></a><a href="javascript:;" title="#ff9800" style="color:#ff9800;"></a><a href="javascript:;" title="#ff5722" style="color:#ff5722;"></a><a href="javascript:;" title="#795548" style="color:#795548;"></a><a href="javascript:;" title="#607D8B" style="color:#607D8B;"></a><a href="javascript:;" title="#2a2b33" style="color:#2a2b33;"></a></div></div></a> <a href="/" class="theme-header__name router-link-active">
        2333Ge
      </a> <p class="theme-header__slogan">ä¸€ä¸ª95åç¨‹åºçŒ¿çš„å­¦ä¹ å°ç«™</p></div> <div class="theme-SubNav"><a href="/archives/" class="theme-SubNav__item"><span class="theme-SubNav__count">47</span> <span class="theme-SubNav__name">Archives</span></a> <a href="/categories/" class="theme-SubNav__item"><span class="theme-SubNav__count">19</span> <span class="theme-SubNav__name">Categories</span></a> <a href="/tags/" class="theme-SubNav__item"><span class="theme-SubNav__count">25</span> <span class="theme-SubNav__name">Tags</span></a></div> <div class="theme-nav"><div class="search-box mt-7"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  ğŸ  ä¸»é¡µ
</a></div> <!----></nav></div> <div class="theme-footer"><div class="social-links"><a target="_blank" rel="external nofollow noopener" title="email" href="mailto:ych.class@qq.com" class="icon-email">email</a><a target="_blank" rel="external nofollow noopener" title="github" href="https://github.com/2333Ge" class="icon-github">github</a></div> <p class="copyright"></p> <p class="powered"><span>Powered by <a href="https://vuepress.vuejs.org" target="_blank" rel="external nofollow noopener">VuePress</a></span> <span class="Ï†de"> Theme - <a href="https://github.com/80maker/vuepress-theme-maker" target="_blank" rel="external nofollow noopener">Maker</a></span></p></div></div></div> <div class="theme-main"><div class="theme-main__inner post"><article itemscope="itemscope" itemtype="https://schema.org/BlogPosting"><header class="article__header"><h1 itemprop="name headline" class="post-title">
          ã€ŠMastering Gradleã€‹ç¬”è®°
        </h1> <div class="post-meta"><!----> <div class="post-meta__date"><i class="icon-calendar"></i> <time pubdate itemprop="datePublished" datetime="2022-04-02T00:00:00.000Z">
      Apr 02, 2022
    </time></div> <div class="post-meta__cates"><i class="icon-cate"></i> <a href="/categories/Gradle/">
      Gradle
    </a></div> <div class="post-meta__reading"><i class="icon-time"></i>
    3.2k words in 13 min
  </div> <div id="" data-flag-title="Your Article Title" class="leancloud_visitors"><i class="icon-eye"></i> <i class="leancloud-visitors-count">--</i></div></div></header> <div class="article-con"><div itemprop="articleBody" class="article-content content__default copy-code-enabled"><h1 id="å‰è¨€"><a href="#å‰è¨€" class="header-anchor">#</a> å‰è¨€</h1> <ul><li>åŸä¹¦ï¼šhttps://juejin.cn/book/6844733819363262472</li> <li>demo: demo/gradle-demo</li></ul> <h2 id="å®‰è£…"><a href="#å®‰è£…" class="header-anchor">#</a> å®‰è£…</h2> <h2 id="hello-world"><a href="#hello-world" class="header-anchor">#</a> Hello World</h2> <p>æ‰§è¡Œ gradle æ—¶, Gradle ä¼šä»å½“å‰ç›®å½•ä¸­å¯»æ‰¾åä¸º &quot;build.gradle&quot; æˆ– &quot;build.gradle.kts&quot; çš„æ–‡ä»¶</p> <h2 id="ä¼ é€’å‚æ•°"><a href="#ä¼ é€’å‚æ•°" class="header-anchor">#</a> ä¼ é€’å‚æ•°</h2> <p>å‘½ä»¤è¡Œå‚æ•° &gt; GRADLE_USER_HOME gradle.properties æ–‡ä»¶ &gt; é¡¹ç›®æ ¹ç›®å½• gradle.properties æ–‡ä»¶</p> <blockquote><p>Gradle User Home(åœ¨å“ªå„¿ï¼Ÿï¼Ÿ)
User Home ä¸­ä¸»è¦ä¿å­˜å…¨å±€é…ç½®, å…¨å±€åˆå§‹åŒ–è„šæœ¬ä»¥åŠä¾èµ–çš„ç¼“å­˜å’Œæ—¥å¿—ç­‰æ–‡ä»¶. å¦‚æœå¼€å¯ build cache çš„è¯, æ„å»ºç¼“å­˜ä¹Ÿä¼šå­˜åœ¨è¿™é‡Œå…±æ‰€æœ‰é¡¹ç›®å…±äº«.</p></blockquote> <p>å…³é”®è¯ï¼šå¢é‡ç¼–è¯‘(Incremental Build) ä¸ ç¼“å­˜(Caching)ã€å‚æ•°</p> <h2 id="ä»»åŠ¡-task"><a href="#ä»»åŠ¡-task" class="header-anchor">#</a> ä»»åŠ¡(Task)</h2> <p>??? delegate properties</p> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code>tasks<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;foo&quot;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">println</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;...&quot;</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>tasks æ˜¯è„šæœ¬çš„ &quot;å…¨å±€å˜é‡&quot;, ç”¨äºåˆ›å»ºå’Œç®¡ç†å„å¼å„æ ·çš„ä»»åŠ¡</p> <h3 id="_1-åˆ›å»º-task"><a href="#_1-åˆ›å»º-task" class="header-anchor">#</a> 1. åˆ›å»º task</h3> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code><span class="token comment">// æ–¹å¼1ï¼š é€šè¿‡ name æ³¨å†Œ task</span>
tasks<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;foo&quot;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// é…ç½®é˜¶æ®µ</span>
    <span class="token function">println</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;configure phase...&quot;</span></span><span class="token punctuation">)</span>

    doLast <span class="token punctuation">{</span>
        <span class="token comment">// æ‰§è¡Œé˜¶æ®µ</span>
        <span class="token function">println</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;execution phase...&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// ï¼Ÿï¼Ÿæ–¹å¼2ï¼šé€šè¿‡ Kotlin delegate properties åˆ›å»ºä»»åŠ¡</span>
<span class="token keyword">val</span> bar <span class="token keyword">by</span> tasks<span class="token punctuation">.</span><span class="token function">creating</span> <span class="token punctuation">{</span>
  <span class="token operator">..</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
<span class="token comment">// æ–¹å¼3ï¼šç»§æ‰¿ DefaultTask</span>
<span class="token keyword">open</span> <span class="token keyword">class</span> HelloTask <span class="token operator">:</span> <span class="token function">DefaultTask</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">init</span> <span class="token punctuation">{</span>
        <span class="token comment">// é…ç½®é˜¶æ®µ</span>
        <span class="token function">println</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;configure phase...&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token annotation builtin">@TaskAction</span>
    <span class="token keyword">fun</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// æ‰§è¡Œé˜¶æ®µ</span>
        <span class="token function">println</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;execution phase...&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

tasks<span class="token punctuation">.</span>create<span class="token operator">&lt;</span>HelloTask<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;foo&quot;</span></span><span class="token punctuation">)</span>

</code></pre></div><h3 id="_2-è·å–-task"><a href="#_2-è·å–-task" class="header-anchor">#</a> 2. è·å– task</h3> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code><span class="token comment">// é€šè¿‡ name è·å– task</span>
tasks<span class="token punctuation">[</span><span class="token string-literal singleline"><span class="token string">&quot;foo&quot;</span></span><span class="token punctuation">]</span><span class="token punctuation">.</span>name
tasks<span class="token punctuation">.</span><span class="token function">getByName</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;foo&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>name
tasks<span class="token punctuation">.</span>getByName<span class="token operator">&lt;</span>Copy<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;copy&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>destinationDir

<span class="token comment">//??? é€šè¿‡ Kotlin delegate properties è·å–</span>
<span class="token keyword">val</span> foo <span class="token keyword">by</span> tasks<span class="token punctuation">.</span>getting
<span class="token keyword">val</span> copy <span class="token keyword">by</span> tasks<span class="token punctuation">.</span><span class="token function">getting</span><span class="token punctuation">(</span>Copy<span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">)</span>
</code></pre></div><p>å¦‚æœæŸä¸ª task åœ¨å¦å¤–çš„ project ä¸­, åˆ™éœ€è¦æŒ‡å®š task çš„è·¯å¾„</p> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code>tasks<span class="token punctuation">.</span><span class="token function">getByPath</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;:projectA:hello&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span>path
</code></pre></div><h3 id="gradle-è‡ªå¸¦-task"><a href="#gradle-è‡ªå¸¦-task" class="header-anchor">#</a> Gradle è‡ªå¸¦ task</h3> <ul><li>Copy task</li> <li>Zip/Jar/Tar task</li></ul> <h3 id="ä»»åŠ¡ä¾èµ–"><a href="#ä»»åŠ¡ä¾èµ–" class="header-anchor">#</a> ä»»åŠ¡ä¾èµ–</h3> <ol><li>é€šè¿‡åç§°</li> <li>é€šè¿‡ task å¯¹è±¡</li></ol> <p>ä½¿ç”¨ <strong>task-tree</strong> å¯æŸ¥çœ‹ task ä¾èµ–å…³ç³»</p> <h3 id="ä»»åŠ¡æ‰§è¡Œé¡ºåº"><a href="#ä»»åŠ¡æ‰§è¡Œé¡ºåº" class="header-anchor">#</a> ä»»åŠ¡æ‰§è¡Œé¡ºåº</h3> <p>shouldRunAfter å’Œ mustRunAfter</p> <p>dependsOn &gt; shouldRunAfter</p> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code><span class="token keyword">val</span> taskX <span class="token keyword">by</span> tasks<span class="token punctuation">.</span><span class="token function">creating</span> <span class="token punctuation">{</span>
    doLast <span class="token punctuation">{</span>
       <span class="token function">println</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;taskX&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">val</span> taskY <span class="token keyword">by</span> tasks<span class="token punctuation">.</span><span class="token function">creating</span> <span class="token punctuation">{</span>
    doLast <span class="token punctuation">{</span>
        <span class="token function">println</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;taskY&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

taskY <span class="token punctuation">{</span> <span class="token function">mustRunAfter</span><span class="token punctuation">(</span>taskX<span class="token punctuation">)</span> <span class="token punctuation">}</span>

</code></pre></div><h2 id="gradle-ç”Ÿå‘½å‘¨æœŸ"><a href="#gradle-ç”Ÿå‘½å‘¨æœŸ" class="header-anchor">#</a> Gradle ç”Ÿå‘½å‘¨æœŸ</h2> <p>ä¸»é¢˜æµç¨‹å¦‚å›¾ï¼Œå¤§è‡´åˆ†ä¸‰é˜¶æ®µ Initialization -&gt; Configuration -&gt; Execution</p> <p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/10/30/16e1c9dc26469187~tplv-t2oaga2asx-watermark.awebp" alt=""></p> <h3 id="initialization"><a href="#initialization" class="header-anchor">#</a> Initialization</h3> <p>Initialization é˜¶æ®µä¸»è¦ç›®çš„æ˜¯åˆå§‹åŒ–æ„å»º,åˆ†ä¸ºä¸¤ä¸ªå­è¿‡ç¨‹</p> <ol><li>ä¸€ä¸ªæ˜¯æ‰§è¡Œ Init Script</li> <li>æ˜¯æ‰§è¡Œ Setting Script</li></ol> <p>Init script åˆå§‹åŒ–å…¨å±€é€šç”¨å±æ€§ç­‰ï¼Œå¾ˆå°‘é…ç½®</p> <p>Setting Script åˆå§‹åŒ–äº†ä¸€æ¬¡æ„å»ºæ‰€å‚ä¸çš„æ‰€æœ‰æ¨¡å—ï¼Œå¯¹äº Android é¡¹ç›®è€Œè¨€, æˆ‘ä»¬åœ¨æ ¹ç›®å½•ä¸‹çœ‹åˆ°çš„ settings.gradle(.kts) å°±æ˜¯ setting script. å‡ ä¹æ¯ä¸ªæˆè§„æ¨¡çš„é¡¹ç›®ä¸­éƒ½ä¼šæœ‰å¤šä¸ªæ¨¡å—ç›¸äº’åˆä½œ, setting script æ­£æ˜¯ç»„ç»‡å’Œç®¡ç†ä¸€ä¸ªé¡¹ç›®ä¸­æ‰€æœ‰æ¨¡å—(æˆ–è€…è¯´å­é¡¹ç›®) çš„è„šæœ¬. æ‰€æœ‰å‚ä¸æ„å»ºçš„é¡¹ç›®éƒ½éœ€è¦åœ¨ setting script ä¸­æè¿°, æœ¬æœºä»»ä½•ä½ç½®çš„é¡¹ç›®éƒ½å¯ä»¥é€šè¿‡ setting script è¢«å¼•å…¥åˆ°å½“å‰æ„å»ºä¸­.</p> <h3 id="configuration"><a href="#configuration" class="header-anchor">#</a> Configuration</h3> <p>æ‰§è¡Œæ‰€æœ‰ build.gradle(.kts)ï¼Œåˆ›å»ºå¯¹åº” task
Task ç»„æˆçš„æœ‰å‘æ— ç¯å›¾ä¾¿æ˜¯åœ¨è¿™ä¸ªé˜¶æ®µç”Ÿæˆçš„ã€‚</p> <h3 id="execution"><a href="#execution" class="header-anchor">#</a> Execution</h3> <p>å¯¹äº Java è€Œè¨€æ˜¯è°ƒç”¨ javac ç¼–è¯‘æºç , ç„¶åæ‰“åŒ…æˆ jar. å¯¹äº Android è€Œè¨€åˆ™æ›´åŠ å¤æ‚äº›.</p> <h3 id="ç”Ÿå‘½å‘¨æœŸ-hook"><a href="#ç”Ÿå‘½å‘¨æœŸ-hook" class="header-anchor">#</a> ç”Ÿå‘½å‘¨æœŸ Hook</h3> <p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/10/30/16e1c9dc26330d6a~tplv-t2oaga2asx-watermark.awebp" alt="ç”Ÿå‘½å‘¨æœŸHook"></p> <p>å„ Hook ä»‹ç»å¯<a href="https://juejin.cn/book/6844733819363262472/section/6844733819421999118" target="_blank" rel="noopener noreferrer"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="init-script"><a href="#init-script" class="header-anchor">#</a> Init Script</h2> <p>ç”±äº init script ä¸»è¦ä»»åŠ¡æ˜¯å…¨å±€ gradle é…ç½®, å› æ­¤ Api åˆ†ä¸ºä¸‰å¤§éƒ¨åˆ†: è·å–å…¨å±€å±æ€§, é¡¹ç›®é…ç½®, ç”Ÿå‘½å‘¨æœŸ Hook.</p> <p>ç”±äº init script æ˜¯æœ€æ—©æ‰§è¡Œçš„è„šæœ¬, å› æ­¤èƒ½ç›‘å¬å‡ ä¹æ‰€æœ‰çš„äº‹ä»¶</p> <h3 id="å¸¸è§ç”¨æ³•"><a href="#å¸¸è§ç”¨æ³•" class="header-anchor">#</a> å¸¸è§ç”¨æ³•</h3> <ol><li>ä¸ºæ‰€æœ‰æ„å»ºå¢åŠ æ’ä»¶ä»“åº“</li></ol> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code>settingsEvaluated <span class="token punctuation">{</span> settings <span class="token operator">-&gt;</span>
    settings<span class="token punctuation">.</span><span class="token function">pluginManagement</span> <span class="token punctuation">{</span>
        repositories <span class="token punctuation">{</span>
            <span class="token function">maven</span><span class="token punctuation">(</span>url <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;../maven-repo&quot;</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><ol start="2"><li>å¯¹æ‰€æœ‰æ„å»º åº”ç”¨ scan æ’ä»¶</li></ol> <p>ç”¨äºä¼˜åŒ–æ„ä»¶é€Ÿåº¦ã€æŸ¥çœ‹å†³è®®ï¼Ÿï¼Ÿè¯¦æƒ…</p> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code>initscript <span class="token punctuation">{</span>
    repositories <span class="token punctuation">{</span>
        <span class="token function">gradlePluginPortal</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    dependencies <span class="token punctuation">{</span>
        <span class="token function">classpath</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;com.gradle:build-scan-plugin:2.1&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

rootProject <span class="token punctuation">{</span>
    apply<span class="token operator">&lt;</span>com<span class="token punctuation">.</span>gradle<span class="token punctuation">.</span>scan<span class="token punctuation">.</span>plugin<span class="token punctuation">.</span>BuildScanPlugin<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    configure<span class="token operator">&lt;</span>com<span class="token punctuation">.</span>gradle<span class="token punctuation">.</span>scan<span class="token punctuation">.</span>plugin<span class="token punctuation">.</span>BuildScanExtension<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">publishAlways</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        termsOfServiceUrl <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;https://gradle.com/terms-of-service&quot;</span></span>
        termsOfServiceAgree <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;yes&quot;</span></span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="setting-script"><a href="#setting-script" class="header-anchor">#</a> Setting Script</h2> <p>setting script æ‰¿æ‹…äº†ç»Ÿç­¹æ‰€æœ‰æ¨¡å—çš„é‡ä»», å› æ­¤ api ä¸»è¦æ˜¯åœ¨æ“ä½œæ‰€å‚ä¸æ„å»ºçš„æ¨¡å—ä»¥åŠç®¡ç†æ„å»ºè¿‡ç¨‹éœ€è¦çš„æ’ä»¶.</p> <h3 id="è®¾ç½®å‚ä¸æ„å»ºçš„æ¨¡å—"><a href="#è®¾ç½®å‚ä¸æ„å»ºçš„æ¨¡å—" class="header-anchor">#</a> è®¾ç½®å‚ä¸æ„å»ºçš„æ¨¡å—</h3> <div class="language- extra-class"><pre class="language-text"><code>include(&quot;:app&quot;, &quot;:libs:someLibrary&quot;)

include(&quot;:anotherLibrary&quot;)
project(&quot;:anotherLibrary&quot;).projectDir = File(rootDir, &quot;../another-library&quot;)
</code></pre></div><h3 id="ç®¡ç†-plugin"><a href="#ç®¡ç†-plugin" class="header-anchor">#</a> ç®¡ç† plugin</h3> <p>ä½¿ç”¨åœºæ™¯ä¸¾ä¾‹</p> <ol><li>æŒ‡å®šä»“åº“</li></ol> <p>æˆ‘ä»¬åœ¨ build script ä¸­é€šè¿‡ plugins {...} å¼•å…¥æ’ä»¶çš„æ—¶å€™, é»˜è®¤åªä» Gradle å®˜æ–¹æ’ä»¶ä»“åº“ æŸ¥æ‰¾. å¦‚æœæˆ‘ä»¬çš„æ’ä»¶ä¸åœ¨å®˜æ–¹ä»“åº“, å°±éœ€è¦åœ¨è¿™é‡ŒæŒ‡å®šæŸ¥æ‰¾çš„ä»“åº“:</p> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code><span class="token comment">// setting script</span>

pluginManagement <span class="token punctuation">{</span>
    repositories <span class="token punctuation">{</span>
        <span class="token function">maven</span><span class="token punctuation">(</span>url <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;../maven-repo&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>æ¨¡å—æ›¿æ¢åŠŸèƒ½</li></ol> <p>åœ¨å¼•ç”¨é Gradle å®˜æ–¹ plugin çš„æ—¶å€™å¸¸ç”¨</p> <p>ä¾‹å¦‚åœ¨ Android ä¸­, plugins { id(&quot;com.android.application&quot;) } ä¸­å¼•ç”¨ android application æ’ä»¶æ—¶, Gradle é»˜è®¤æŸ¥æ‰¾åä¸º com.android.application:com.android.application.gradle.plugin:[version] çš„æ’ä»¶, è€Œå®é™… google ä»“åº“ä¸­, æ’ä»¶çš„ id æ˜¯ com.android.tools.build:gradle:[version]</p> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code><span class="token function">include</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token operator">..</span><span class="token punctuation">)</span>

pluginManagement <span class="token punctuation">{</span>
    repositories <span class="token punctuation">{</span>
        <span class="token operator">..</span><span class="token operator">..</span>
        <span class="token function">google</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    resolutionStrategy <span class="token punctuation">{</span>
        eachPlugin <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>requested<span class="token punctuation">.</span>id<span class="token punctuation">.</span>namespace <span class="token operator">==</span> <span class="token string-literal singleline"><span class="token string">&quot;com.android&quot;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">useModule</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;com.android.tools.build:gradle:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token expression">requested<span class="token punctuation">.</span>version</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="3"><li>plugin è®¾ç½®ç»Ÿä¸€ç‰ˆæœ¬</li></ol> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code><span class="token comment">// setting script</span>

pluginManagement <span class="token punctuation">{</span>
    resolutionStrategy <span class="token punctuation">{</span>
        eachPlugin <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>requested<span class="token punctuation">.</span>id<span class="token punctuation">.</span>id <span class="token operator">==</span> <span class="token string-literal singleline"><span class="token string">&quot;com.dorongold.task-tree&quot;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">useVersion</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;1.4&quot;</span></span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="build-script"><a href="#build-script" class="header-anchor">#</a> Build Script</h2> <p>å•æ¨¡å—æ„å»ºçš„æ‰§è¡Œæµç¨‹å¤§è‡´ä¸º: init script -&gt; setting script -&gt; build script
å¤šæ¨¡å—çš„æ„å»ºæµç¨‹: init script -&gt; setting script -&gt; root build script -&gt; build script</p> <h3 id="é…ç½®å±æ€§"><a href="#é…ç½®å±æ€§" class="header-anchor">#</a> é…ç½®å±æ€§</h3> <p>é…ç½®, å®é™…ä¸Šæ˜¯å¯¹å¼•å…¥çš„æ’ä»¶è¿›è¡Œé…ç½®. åŸæœ¬ build script ä¸­å¹¶æ²¡æœ‰ android {...} è¿™ä¸ª dsl å±æ€§, è¿™æ˜¯ plugin æä¾›çš„. ä¸€æ—¦åº”ç”¨äº†æŸä¸ªæ’ä»¶, å°±å¯ä»¥ä½¿ç”¨æ’ä»¶æä¾›çš„ dslï¼Ÿï¼Ÿ å¯¹å…¶è¿›è¡Œé…ç½®, ä»è€Œå½±å“è¯¥æ¨¡å—çš„æ„å»ºè¿‡ç¨‹</p> <p>ä»¥ Android æ¨¡å—ä¸ºä¾‹</p> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code>plugins <span class="token punctuation">{</span>
    <span class="token function">id</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;com.android.application&quot;</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

android <span class="token punctuation">{</span>
    <span class="token function">compileSdkVersion</span><span class="token punctuation">(</span><span class="token number">28</span><span class="token punctuation">)</span>

    defaultConfig <span class="token punctuation">{</span>
        <span class="token operator">..</span><span class="token operator">..</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æˆ‘ä»¬é€šè¿‡ <code>plugins { id(&quot;com.android.application&quot;) }</code> å¼•å…¥äº† android application æ’ä»¶, è¿™ä¸ªæ’ä»¶ä¼šåœ¨ Project å¯¹è±¡ä¸Šå¢åŠ  <code>android { .... }</code> é…ç½®æ–¹æ³•, è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå¼•å…¥ç›¸åº”çš„æ’ä»¶åæˆ‘ä»¬æ‰èƒ½å¤Ÿå¯¹æŸäº›å±æ€§è¿›è¡Œé…ç½®. æˆ‘ä»¬è¦åšçš„å°±æ˜¯åœ¨ build script ä¸­è°ƒç”¨æ’ä»¶æä¾›çš„å±æ€§è¿›è¡Œé…ç½®, ä¸ºæ’ä»¶å·¥ä½œæä¾›å¿…è¦çš„ä¿¡æ¯. ä¾‹å¦‚, æˆ‘ä»¬è®¾ç½®çš„ <code>android { compileSdkVersion(28) }</code> å°±æ˜¯å‘Šè¯‰ Gradle &quot;ä½¿ç”¨ API 28 ç¼–è¯‘è¿™ä¸ªæ¨¡å—&quot;.</p> <h3 id="å†…ç½®å±æ€§"><a href="#å†…ç½®å±æ€§" class="header-anchor">#</a> å†…ç½®å±æ€§</h3> <p>build script èƒŒåæ˜¯ Project ç±»å‹çš„å¯¹è±¡ï¼Œ Project å¯¹è±¡ æœ¬èº«ä¹Ÿæä¾›äº†å¾ˆå¤šç”¨äºé…ç½®æ„å»ºçš„ dsl,å¦‚ï¼š</p> <ol><li>è®¾ç½®ä¾èµ–æŸ¥æ‰¾ä»“åº“</li></ol> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code>allprojects <span class="token punctuation">{</span>
    repositories <span class="token punctuation">{</span>
        <span class="token function">google</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token function">jcenter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>å¦‚æœæŸä¸ªä¾èµ–å­˜åœ¨äºæˆ‘ä»¬çš„ç§æœ‰ä»“åº“ä¸­, åˆ™å¯ä»¥é€šè¿‡ maven æ–¹æ³•è®¾ç½®ç§æœ‰ä»“åº“</li></ol> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code>repositories <span class="token punctuation">{</span>
    maven <span class="token punctuation">{</span>
        url <span class="token operator">=</span> <span class="token function">uri</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="3"><li>å¦‚æœ maven ä»“åº“éœ€è¦è®¤è¯, åˆ™é€šè¿‡ credentials æ·»åŠ ç”¨æˆ·åå¯†ç :</li></ol> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code>repositories <span class="token punctuation">{</span>
    maven <span class="token punctuation">{</span>
        url <span class="token operator">=</span> <span class="token function">uri</span><span class="token punctuation">(</span><span class="token operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span>

        credentials <span class="token punctuation">{</span>
            username <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;joe&quot;</span></span>
            password <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;secret&quot;</span></span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="4"><li>è®¾ç½®è‡ªå®šä¹‰å˜é‡: ext
<img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/10/30/16e1c9f2c5ba1247~tplv-t2oaga2asx-watermark.awebp" alt=""></li></ol> <h3 id="build-script-ä¹‹é—´çš„å¼•ç”¨åŠä¾èµ–"><a href="#build-script-ä¹‹é—´çš„å¼•ç”¨åŠä¾èµ–" class="header-anchor">#</a> build script ä¹‹é—´çš„å¼•ç”¨åŠä¾èµ–</h3> <p>æ— è®ºåœ¨å“ªä¸ª build script ä¸­, éƒ½å¯ä»¥é€šè¿‡ rootProject è·å–åˆ° root build script æ‰€å¯¹åº”çš„å¯¹è±¡. çˆ¶æ¨¡å—å¯ä»¥é€šè¿‡ subprojects è·å–åˆ°æ‰€æœ‰çš„å­æ¨¡å—, å­æ¨¡å—å¯ä»¥é€šè¿‡ parent è·å–åˆ°çˆ¶æ¨¡å—. å¦‚æœä¸¤ä¸ªæ¨¡å—ä¹‹é—´æ²¡æœ‰ç›´ç³»å…³ç³», åˆ™å¯ä»¥é€šè¿‡ findProject å¼•ç”¨.</p> <blockquote><p>åœ¨å¤šé¡¹ç›®æ„å»ºä¸­, é€šå¸¸ repositories å‡ºç°åœ¨ root build script ä¸­, è€Œ module build script ä¸­åªåŒ…å« dependencies {...} éƒ¨åˆ†</p></blockquote> <blockquote><p>å…¶ä»– project å±æ€§ã€æ–¹æ³•å‚è€ƒ<a href="https://docs.gradle.org/6.0.1/dsl/org.gradle.api.Project.html#N15127" target="_blank" rel="noopener noreferrer">å®˜æ–¹ API æ–‡æ¡£<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h2 id="ä¾èµ–è§„åˆ™"><a href="#ä¾èµ–è§„åˆ™" class="header-anchor">#</a> ä¾èµ–è§„åˆ™</h2> <p>å¤§éƒ¨åˆ†é¡¹ç›®éƒ½æ˜¯ç”±è¯¸å¤šç¬¬ä¸‰æ–¹ä¾èµ–ç»„æˆçš„. åœ¨ Gradle ä¸­, ä¾èµ–ä¸æ˜¯ç‹¬ç«‹å­˜åœ¨çš„. æ¯ä¸ªä¾èµ–éƒ½ä¼šå½’å±äºä¸€ä¸ª Configuration. å®ƒä»¬çš„å…³ç³»å¦‚ä¸‹:</p> <p><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/12/30/16f551f99c602289~tplv-t2oaga2asx-watermark.awebp" alt=""></p> <p>æ¯ä¸ª Project å¯ä»¥æœ‰å¤šä¸ª Configuration. æˆ‘ä»¬å¯ä»¥é€šè¿‡ configurations å¼•ç”¨åˆ°å½“å‰é¡¹ç›®çš„æ‰€æœ‰çš„ configuration.</p> <p>æ¯ä¸ª Configuration å®é™…ä¸Šæ˜¯ dependency çš„é›†åˆ, ä¾¿äºä¸åŒæ„å»ºæ­¥éª¤å¼•ç”¨ä¾èµ–</p> <h3 id="å¸¸è§-configuration"><a href="#å¸¸è§-configuration" class="header-anchor">#</a> å¸¸è§ Configuration</h3> <ul><li>implementation ä¾èµ–ä¼šå‡ºç°åœ¨ç¼–è¯‘äº§ç‰©ä¸­. ä½†æ˜¯æœ€ç»ˆäº§ç‰©ä¸­çš„è¯¥ä¾èµ–ä¸ä¼šå‘å¤–æš´éœ²æ¥å£. è¿™- ç§æ–¹å¼å¯ä»¥æœ‰æ•ˆå‡å°‘ recompile æ—¶æ‰€éœ€è¦ç¼–è¯‘çš„æ¨¡å—, æé«˜ç¼–è¯‘é€Ÿåº¦.</li> <li>api åŒä¸Š, ä½†æ˜¯åœ¨ç¼–è¯‘æœŸä¼šä¼ é€’ä¾èµ–ç»™å¤–éƒ¨.</li> <li>compileOnly ä»…ç¼–è¯‘æœŸæœ‰æ•ˆ, ä¸ä¼šå‡ºç°åœ¨æœ€ç»ˆäº§ç‰©ä¸­</li> <li>runtimeOnly ä»…è¿è¡ŒæœŸæœ‰æ•ˆ, ä¼šå‡ºç°åœ¨ç¼–è¯‘äº§ç‰©ä¸­</li> <li>annotationProcessor æ³¨è§£å¤„ç†å™¨ä¾èµ–(åŒ…å« META-INF/services/javax.- annotation.processing.Processor çš„ jar åŒ…)</li></ul> <h3 id="configuration-ç»§æ‰¿"><a href="#configuration-ç»§æ‰¿" class="header-anchor">#</a> Configuration ç»§æ‰¿</h3> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code>dependencies <span class="token punctuation">{</span>
    testCompile 'com<span class="token punctuation">.</span>squareup<span class="token punctuation">.</span>assertj<span class="token operator">:</span>assertj<span class="token operator">-</span>android<span class="token operator">:</span><span class="token number">1.1</span><span class="token punctuation">.</span><span class="token number">1</span>'
    testCompile 'junit<span class="token operator">:</span>junit<span class="token operator">:</span><span class="token number">4.12</span>'
    androidTestCompile 'com<span class="token punctuation">.</span>squareup<span class="token punctuation">.</span>assertj<span class="token operator">:</span>assertj<span class="token operator">-</span>android<span class="token operator">:</span><span class="token number">1.1</span><span class="token punctuation">.</span><span class="token number">1</span>'
    androidTestCompile 'junit<span class="token operator">:</span>junit<span class="token operator">:</span><span class="token number">4.12</span>'
<span class="token punctuation">}</span>
</code></pre></div><p>ä¸Šä¾‹ä¸­ testCompile ä¸ androidTestCompile å…±åŒçš„ä¾èµ–è¢«ä¹¦å†™äº†ä¸¤æ¬¡,è¿™æ—¶å°±å¯ä»¥é€šè¿‡å®šä¹‰ä¸€ä¸ªå…¬å…±çš„ configuration, åŒæ—¶è®© testCompile å’Œ androidTestCompile ç»§æ‰¿ä¸è¿™ä¸ªå…¬å…±ä¾èµ–å³å¯</p> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code>configurations <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>androidTestCompile<span class="token punctuation">,</span> testCompile<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">each</span> <span class="token punctuation">{</span> it<span class="token punctuation">.</span>extendsFrom commonTestCompile <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

dependencies <span class="token punctuation">{</span>
    commonTestCompile 'com<span class="token punctuation">.</span>squareup<span class="token punctuation">.</span>assertj<span class="token operator">:</span>assertj<span class="token operator">-</span>android<span class="token operator">:</span><span class="token number">1.1</span><span class="token punctuation">.</span><span class="token number">1</span>'
    commonTestCompile 'junit<span class="token operator">:</span>junit<span class="token operator">:</span><span class="token number">4.12</span>'
<span class="token punctuation">}</span>
</code></pre></div><h3 id="å¸¸è§ä¾èµ–é—®é¢˜"><a href="#å¸¸è§ä¾èµ–é—®é¢˜" class="header-anchor">#</a> å¸¸è§ä¾èµ–é—®é¢˜</h3> <p>ä¾èµ–å†³è®®æ˜¯æŒ‡ &quot;åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­, å¦‚æœå­˜åœ¨æŸä¸ªä¾èµ–çš„å¤šä¸ªç‰ˆæœ¬, æ„å»ºç³»ç»Ÿåº”è¯¥é€‰æ‹©å“ªä¸ªè¿›è¡Œæ„å»ºçš„é—®é¢˜&quot;. æ— è®ºæ˜¯æ–°æ‰‹è¿˜æ˜¯è€æ‰‹, ç¼–è¯‘å¤±è´¥å¤§éƒ¨åˆ†æƒ…å†µéƒ½æ˜¯ç”±å†³è®®é”™è¯¯å¯¼è‡´çš„.</p> <ul><li>debugCompileClasspath / releaseCompileClasspath</li></ul> <p>ç¼–è¯‘æœŸå‘ç”Ÿ 'xxx Not Found', æœ¬è´¨å°±æ˜¯åœ¨è¿™ä¸ª configuration ä¸­æ²¡æœ‰å¯¹åº”çš„ä»£ç .
é€šå¸¸æ˜¯ç”±äºæ²¡æœ‰ä¾èµ–æ­£ç¡®çš„åº“å¯¼è‡´çš„. æ’æŸ¥</p> <ul><li>debugRuntimeClasspath / releaseRuntimeClasspath</li></ul> <p>è¿è¡ŒæœŸå‘ç”Ÿ 'xxx Not Found', æœ¬è´¨å°±æ˜¯åœ¨è¿™ä¸ª configuration ä¸­æ²¡æœ‰å¯¹åº”çš„ä»£ç .
é€šå¸¸æ˜¯ç”±äºä½¿ç”¨äº† compileOnly(xxx) ä»…ä»…åœ¨ç¼–è¯‘æœŸä¾èµ–æŸäº›åº“å¯¼è‡´.</p> <h3 id="implementation"><a href="#implementation" class="header-anchor">#</a> implementation</h3> <h4 id="isforce"><a href="#isforce" class="header-anchor">#</a> isForce</h4> <p>å†³è®®å†²çªæ—¶æ˜¯å¦å¼ºåˆ¶ä½¿ç”¨å½“å‰ç‰ˆæœ¬, booleanï¼Œåªå½±å“å½“å‰æ¨¡å—</p> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code>dependencies <span class="token punctuation">{</span>
    <span class="token function">implementation</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;io.reactivex.rxjava2:rxjava:2.2.6&quot;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        isForce <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
    <span class="token function">implementation</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;io.reactivex.rxjava2:rxjava:2.2.10&quot;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        isForce <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="exclude"><a href="#exclude" class="header-anchor">#</a> exclude</h3> <p>ç”¨äºæ’é™¤æŸä¸ªæˆ–è€…æŸç»„ä¼ é€’ä¾èµ–:ç›´æ¥å†™åœ¨ dependencies ä»£ç å—ä¸­çš„ä¾èµ–å«åš ç›´æ¥ä¾èµ–. è€Œé€šè¿‡æŸä¸ªä¾èµ–ä»è€Œé—´æ¥å¼•å…¥çš„å…¶å®ƒä¾èµ–é¡¹å«åš é—´æ¥ä¾èµ– æˆ– ä¼ é€’ä¾èµ–. Gradle ä¸­æä¾›äº†æ’é™¤é—´æ¥ä¾èµ–çš„æ–¹å¼</p> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code><span class="token function">implementation</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;io.reactivex.rxjava2:rxandroid:2.1.1&quot;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token function">exclude</span><span class="token punctuation">(</span>group <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;io.reactivex.rxjava2&quot;</span></span><span class="token punctuation">,</span> module <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;rxjava&quot;</span></span><span class="token punctuation">)</span>

    <span class="token function">exclude</span><span class="token punctuation">(</span>group <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">&quot;io.reactivex.rxjava2&quot;</span></span><span class="token punctuation">)</span>

<span class="token punctuation">}</span>

</code></pre></div><h3 id="å¤šé¡¹ç›®å…±äº«ä¾èµ–ç‰ˆæœ¬"><a href="#å¤šé¡¹ç›®å…±äº«ä¾èµ–ç‰ˆæœ¬" class="header-anchor">#</a> å¤šé¡¹ç›®å…±äº«ä¾èµ–ç‰ˆæœ¬</h3> <p><a href="https://docs.gradle.org/6.0.1/userguide/dependency_management_terminology.html#sub::terminology_platform" target="_blank" rel="noopener noreferrer">platform<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> + constraint å®ç°åœ¨æ‰€æœ‰å­é¡¹ç›®å…±äº«ç‰ˆæœ¬. å¦‚ä¸‹:</p> <ol><li>åˆ›å»ºä¸€ä¸ªå­é¡¹ç›®, æ¯”å¦‚å«åš bom, ä¸“é—¨ç”¨äºç®¡ç†ç‰ˆæœ¬</li></ol> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code><span class="token comment">// bom/build.gradle.kts</span>

plugins <span class="token punctuation">{</span>
    `java<span class="token operator">-</span>platform`
<span class="token punctuation">}</span>

dependencies <span class="token punctuation">{</span>
    constraints <span class="token punctuation">{</span>
        <span class="token function">implementation</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;io.reactivex.rxjava2:rxjava:2.2.0&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>åœ¨å…¶ä»–å­é¡¹ç›®ä¸­é€šè¿‡ platform å¼•å…¥ &quot;ç‰ˆæœ¬é¡¹ç›®&quot; bom</li></ol> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code>
<span class="token comment">// foo/build.gradle.kts</span>

dependencies <span class="token punctuation">{</span>
<span class="token function">implementation</span><span class="token punctuation">(</span><span class="token function">platform</span><span class="token punctuation">(</span><span class="token function">project</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;:bom&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment">// No version needed</span>
    <span class="token function">implementation</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;io.reactivex.rxjava2:rxjava&quot;</span></span><span class="token punctuation">)</span>

<span class="token punctuation">}</span>
</code></pre></div><p>åªéœ€è¦ implementation(platform(project(&quot;:bom&quot;))) å³å¯å°† bom å·¥ç¨‹æ‰€æœ‰çš„ä¾èµ–çº¦æŸå¼•å…¥, æ–¹ä¾¿åœ¨å­é¡¹ç›®ä¸­å…±äº«</p> <h3 id="ä¾èµ–ç‰ˆæœ¬å·"><a href="#ä¾èµ–ç‰ˆæœ¬å·" class="header-anchor">#</a> ä¾èµ–ç‰ˆæœ¬å·</h3> <table><thead><tr><th style="text-align:center;">è¡¨è¾¾å¼</th> <th style="text-align:center;">æè¿°</th></tr></thead> <tbody><tr><td style="text-align:center;">1.3, 1.3.0-beta3, 1.0-20150201.131010-1</td> <td style="text-align:center;">å›ºå®šç‰ˆæœ¬</td></tr> <tr><td style="text-align:center;">[1.0.0, 1.3.0)</td> <td style="text-align:center;">å¤§äºç­‰äº 1.0.0 ä¸”å°äº 1.3.0 çš„ç‰ˆæœ¬. å…¶ä¸­ ')' å¯ä»¥ä½¿ç”¨ '[' ä»£</td></tr> <tr><td style="text-align:center;">1.+, [1.0,)</td> <td style="text-align:center;">å¤§äºç­‰äº 1.0 çš„ç‰ˆæœ¬</td></tr> <tr><td style="text-align:center;">latest.integration, latest.release</td> <td style="text-align:center;">æœ€æ–°ç‰ˆæœ¬</td></tr></tbody></table> <h3 id="ä¾èµ–ç‰ˆæœ¬åŠ›åº¦"><a href="#ä¾èµ–ç‰ˆæœ¬åŠ›åº¦" class="header-anchor">#</a> ä¾èµ–ç‰ˆæœ¬åŠ›åº¦</h3> <p>æ§åˆ¶ä¾èµ–çš„ä¾èµ–ï¼Œrequiredã€strictlyã€prefer å’Œ rejectï¼Œ<a href="https://juejin.cn/book/6844733819363262472/section/6844733819426209799" target="_blank" rel="noopener noreferrer">è§<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="ä¾èµ–æŸ¥æ‰¾-åˆ†æ"><a href="#ä¾èµ–æŸ¥æ‰¾-åˆ†æ" class="header-anchor">#</a> ä¾èµ–æŸ¥æ‰¾&amp;åˆ†æ</h3> <p>ä¾èµ–çš„ä¼ é€’ç‰¹æ€§å¯¼è‡´é¡¹ç›®ä¸­æ‰€ä¾èµ–çš„ç‰ˆæœ¬å®é™…ä¸Šæ˜¯ å†³è®® çš„ç»“æœ. å½“é¡¹ç›®å˜å¤§æˆ–è€…å¼•å…¥å¤§é‡ä¸‰æ–¹ä¾èµ–å, å¾ˆéš¾äº†è§£å½“å‰é¡¹ç›®ä¸­æ‰€æœ‰çš„ä¾èµ–å…³ç³»ä»¥åŠå¯¹åº”çš„ç‰ˆæœ¬. è¿™æ—¶å°±éœ€è¦é€šè¿‡ä¾èµ–åˆ†æ.</p> <ol><li><a href="https://docs.gradle.org/6.0.1/userguide/viewing_debugging_dependencies.html#sec:listing_dependencies" target="_blank" rel="noopener noreferrer">ä½¿ç”¨ dependencies ä»»åŠ¡åˆ†æä¾èµ–<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ol> <div class="language-sh extra-class"><pre class="language-sh"><code>./gradlew :app:dependencies
</code></pre></div><p>ä¸€èˆ¬æ— éœ€æ‰“å°æ‰€æœ‰ configurationï¼Œå¯ç”¨å‚æ•°æ§åˆ¶è¾“å‡º</p> <div class="language-sh extra-class"><pre class="language-sh"><code>./gradlew :app:dependencies --configuration compileClasspath
</code></pre></div><ol start="2"><li><a href="https://docs.gradle.org/6.0.1/userguide/viewing_debugging_dependencies.html#sec:debugging-build-scans" target="_blank" rel="noopener noreferrer">ä½¿ç”¨ build scan åˆ†æ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ol> <div class="language-sh extra-class"><pre class="language-sh"><code>./gradlew build --scan
</code></pre></div><ol start="3"><li>ä¾èµ–æŸ¥æ‰¾</li></ol> <p>å½“æˆ‘ä»¬æƒ³ç€é‡åˆ†ææŸä¸€ä¸ªä¾èµ–æ—¶, å¯ä»¥é€šè¿‡ dependencyInsight ä»»åŠ¡, ä»è¢«ä¾èµ–çš„ç›®æ ‡åå‘æŸ¥æ‰¾ä¾èµ–å…³ç³». ä¾‹å¦‚:</p> <div class="language-sh extra-class"><pre class="language-sh"><code>./gradlew :app:dependencyInsight --configuration debugCompileClasspath --dependency kotlin-stdlib
</code></pre></div><h2 id="android-æ„å»ºè¯¦è§£"><a href="#android-æ„å»ºè¯¦è§£" class="header-anchor">#</a> <a href="https://juejin.cn/book/6844733819363262472/section/6844733819430371341#:~:text=Android%20%E6%9E%84%E5%BB%BA-,%E8%AF%A6,-%E8%A7%A3" target="_blank" rel="noopener noreferrer">Android æ„å»ºè¯¦è§£<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h2> <ul><li>å¦‚ä½•æŸ¥æ‰¾ Gradle API</li> <li>æ’ä»¶ï¼šæŸç§ç±»å‹ï¼ˆè¯­è¨€ã€å·¥ç¨‹ç­‰ï¼‰çš„ç¼–è¯‘çš„æ¨¡æ¿</li></ul> <h3 id="å­æ¨¡å—"><a href="#å­æ¨¡å—" class="header-anchor">#</a> å­æ¨¡å—</h3> <p>apply plugin: ... å³æ˜¯åº”ç”¨æ’ä»¶çš„åœ°æ–¹. ä¸€èˆ¬ android æ— éå°±æ˜¯ com.android.application æˆ–è€… com.android.library. ä¸¤è€…éƒ½ä¼šå¼•å…¥ android {...}</p> <p>ä»£ç ã€èµ„æºé…ç½®æµç¨‹
<img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/10/30/16e1c9fc466a804f~tplv-t2oaga2asx-watermark.awebp" alt=""></p> <h3 id="ä»£ç ç›¸å…³é…ç½®"><a href="#ä»£ç ç›¸å…³é…ç½®" class="header-anchor">#</a> ä»£ç ç›¸å…³é…ç½®</h3> <h4 id="æºç ã€èµ„æºç›®å½•é…ç½®"><a href="#æºç ã€èµ„æºç›®å½•é…ç½®" class="header-anchor">#</a> æºç ã€èµ„æºç›®å½•é…ç½®</h4> <p>æ— è®ºæ˜¯æºç è¿˜æ˜¯èµ„æºæ–‡ä»¶, éƒ½é€šè¿‡ sourceSets {...} è¿›è¡Œé…ç½®</p> <p><a href="https://developer.android.google.cn/reference/tools/gradle-api/7.0/com/android/build/api/dsl/AndroidSourceSet" target="_blank" rel="noopener noreferrer">sourceSet<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="èµ„æºæ„å»º"><a href="#èµ„æºæ„å»º" class="header-anchor">#</a> èµ„æºæ„å»º</h3> <p>èµ„æºä¹Ÿåˆ†ä¸ºä¸¤å¤§ç±»ï¼š</p> <ol><li>éœ€è¦ç‰¹æ®Šå¤„ç†</li></ol> <p>src/main/res æ‰€æœ‰èµ„æºéƒ½ä¼šç»è¿‡ Android Asset Packaging Tool(ç®€ç§° aapt)&quot;ç¼–è¯‘&quot;ï¼Œ ä½†æ˜¯ä¸åŒç±»å‹çš„èµ„æºä¼šä»¥ä¸åŒçš„æ–¹å¼è¢«å¤„ç†. ä¾‹å¦‚å›¾ç‰‡èµ„æº, ä¼šè¢«å‹ç¼©åæ”¾å…¥ APK, è€Œå¸ƒå±€çš„ layout æ–‡ä»¶, åˆ™ä¼šä» xml æ ¼å¼è¢«ç¼–è¯‘ä¸ºäºŒè¿›åˆ¶æ ¼å¼å­˜å‚¨ã€‚</p> <p>aapt2 é™¤äº†ä¼šä¼˜åŒ–å­˜å‚¨ç©ºé—´å’Œè¿è¡Œæ—¶è§£æèµ„æºçš„æ•ˆç‡å¤–, è¿˜æœ‰ä¸€ä¸ªé‡è¦çš„ç›®çš„å°±æ˜¯ç”Ÿæˆ R æ–‡ä»¶.</p> <ol start="2"><li>æ— éœ€ç‰¹æ®Šå¤„ç†</li></ol> <p>ä¾‹å¦‚, app/src/main/assets ç›®å½•ä¸‹çš„èµ„æº, ä»¥åŠ app/libs ä¸‹çš„ so æ–‡ä»¶.</p> <h4 id="é…ç½®"><a href="#é…ç½®" class="header-anchor">#</a> é…ç½®</h4> <p><a href="https://developer.android.google.cn/reference/tools/gradle-api/7.0/com/android/build/api/dsl/AaptOptions" target="_blank" rel="noopener noreferrer">aaptOptions<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>è®¾ç½®æ‰§è¡Œ aapt çš„å‚æ•°</p> <p><a href="https://developer.android.google.cn/reference/tools/gradle-api/7.0/com/android/build/api/dsl/PackagingOptions" target="_blank" rel="noopener noreferrer">packagingOptions<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>å¤„ç†é‡å¤èµ„æº</p> <h3 id="é»˜è®¤é…ç½®"><a href="#é»˜è®¤é…ç½®" class="header-anchor">#</a> é»˜è®¤é…ç½®</h3> <p><a href="https://developer.android.google.cn/reference/tools/gradle-api/7.0/com/android/build/api/dsl/DefaultConfig" target="_blank" rel="noopener noreferrer">defaultConfig<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language- extra-class"><pre class="language-text"><code>android {
    ....

    defaultConfig {
        applicationId = &quot;com.walfud.myapplication&quot;
        applicationIdSuffix = &quot;namesuffix&quot;

        versionCode = 1
        versionName = &quot;1.0.0&quot;
        versionNameSuffix = &quot;alpha&quot;

        manifestPlaceholders = mapOf(&quot;hostName&quot; to &quot;www.example.com&quot;)
    }

    ....
}
</code></pre></div><p>buildConfigField æ–¹æ³•ä¼šåœ¨ç”Ÿæˆ BuildConfig.java æ—¶, å‘å…¶ä¸­æ’å…¥å±æ€§</p> <div class="language-kotlin extra-class"><pre class="language-kotlin"><code><span class="token comment">// build.gradle.kts</span>
android <span class="token punctuation">{</span>
    <span class="token operator">..</span><span class="token operator">..</span>

    defaultConfig <span class="token punctuation">{</span>
        <span class="token function">buildConfigField</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;int&quot;</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">&quot;i&quot;</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">&quot;1234&quot;</span></span><span class="token punctuation">)</span>
        <span class="token function">buildConfigField</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;String&quot;</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">&quot;str&quot;</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">&quot;\&quot;some text\&quot;&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token operator">..</span><span class="token operator">..</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// BuildConfig.java</span>

<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

<span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">BuildConfig</span> <span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token comment">// Fields from default config.</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1234</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> str <span class="token operator">=</span> <span class="token string">&quot;some text&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="header-anchor">#</a> å‚è€ƒæ–‡çŒ®</h2> <ul><li>Gradle å®˜æ–¹æ–‡æ¡£ï¼šhttps://docs.gradle.org/current/userguide/userguide.html</li> <li>android gradle é…ç½®ï¼š https://developer.android.google.cn/reference/tools/gradle-api/7.0/classes</li> <li>kotlin gradle æ–‡æ¡£ï¼š https://book.kotlincn.net/text/mpp-dsl-reference.html</li></ul> <h2 id="éšè®°"><a href="#éšè®°" class="header-anchor">#</a> éšè®°</h2> <ul><li>å®˜ç½‘æŸ¥çœ‹ api</li> <li>scan æŸ¥çœ‹é¡¹ç›®ä¾èµ–æƒ…å†µ</li></ul></div> <div class="article-copyright"><ul><li class="article-copyright__item"><strong class="article-copyright__title">Last-updated<span>:</span></strong> <p class="article-copyright__text"></p></li> <li class="article-copyright__item"><strong class="article-copyright__title">Copyright<span>:</span></strong> <p class="article-copyright__text">è‡ªç”±è½¬è½½-éå•†ç”¨-ç¦æ­¢æ¼”ç»-ä¿æŒç½²åï¼ˆ<a href="http://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh">CC
                BY-NC-ND 4.0</a>ï¼‰</p></li> <li class="article-copyright__item"><strong class="article-copyright__title">Link<span>:</span></strong> <p class="article-copyright__text"><a href="/post/2022/04/02/mastering-gradle-summary.html" title="ã€ŠMastering Gradleã€‹ç¬”è®°">/post/2022/04/02/mastering-gradle-summary.html</a></p></li></ul></div> <!----></div> <div class="article-footer"><ul class="post-tag"><li class="post-tag__item"><a href="/tags/Gradle"><span># Gradle</span></a></li><li class="post-tag__item"><a href="/tags/ide-skill"><span># ide-skill</span></a></li><li class="post-tag__item"><a href="/tags/Reading"><span># Reading</span></a></li></ul> <div class="post-operate"><a href="/post/2022/04/02/vscode.html" class="post-operate__prev">VSCodeå¼€å‘å·¥å…·æ¦‚è§ˆ</a> <a href="/post/2022/04/02/snippet.html" class="post-operate__next">VSCode snippetè‡ªå®šä¹‰ä»£ç æ¨¡æ¿</a></div> <!----></div></article></div></div> <svg style="display:none;"><symbol id="theme-icon-auto" viewBox="0 0 32 32"><path d="M16 0c-8.837 0-16 7.163-16 16s7.163 16 16 16 16-7.163 16-16-7.163-16-16-16zM4 16c0-6.627 5.373-12 12-12v24c-6.627 0-12-5.373-12-12z"></path></symbol> <symbol id="theme-icon-sun" viewBox="0 0 32 32"><path d="M16 26c1.105 0 2 0.895 2 2v2c0 1.105-0.895 2-2 2s-2-0.895-2-2v-2c0-1.105 0.895-2 2-2zM16 6c-1.105 0-2-0.895-2-2v-2c0-1.105 0.895-2 2-2s2 0.895 2 2v2c0 1.105-0.895 2-2 2zM30 14c1.105 0 2 0.895 2 2s-0.895 2-2 2h-2c-1.105 0-2-0.895-2-2s0.895-2 2-2h2zM6 16c0 1.105-0.895 2-2 2h-2c-1.105 0-2-0.895-2-2s0.895-2 2-2h2c1.105 0 2 0.895 2 2zM25.899 23.071l1.414 1.414c0.781 0.781 0.781 2.047 0 2.828s-2.047 0.781-2.828 0l-1.414-1.414c-0.781-0.781-0.781-2.047 0-2.828s2.047-0.781 2.828 0zM6.101 8.929l-1.414-1.414c-0.781-0.781-0.781-2.047 0-2.828s2.047-0.781 2.828 0l1.414 1.414c0.781 0.781 0.781 2.047 0 2.828s-2.047 0.781-2.828 0zM25.899 8.929c-0.781 0.781-2.047 0.781-2.828 0s-0.781-2.047 0-2.828l1.414-1.414c0.781-0.781 2.047-0.781 2.828 0s0.781 2.047 0 2.828l-1.414 1.414zM6.101 23.071c0.781-0.781 2.047-0.781 2.828 0s0.781 2.047 0 2.828l-1.414 1.414c-0.781 0.781-2.047 0.781-2.828 0s-0.781-2.047 0-2.828l1.414-1.414z"></path> <path d="M16 8c-4.418 0-8 3.582-8 8s3.582 8 8 8c4.418 0 8-3.582 8-8s-3.582-8-8-8zM16 21c-2.761 0-5-2.239-5-5s2.239-5 5-5 5 2.239 5 5-2.239 5-5 5z"></path></symbol> <symbol id="theme-icon-moon" viewBox="0 0 18 18"><path d="M7.246 3.255c-0.251 0.828-0.322 1.71-0.198 2.597 0.366 2.63 2.455 4.723 5.080 5.089 0.282 0.040 0.568 0.060 0.85 0.060 0.599 0 1.184-0.087 1.742-0.257-0.674 2.215-2.642 3.926-4.973 4.21-0.254 0.031-0.51 0.047-0.762 0.047-1.713 0-3.349-0.738-4.486-2.024-1.152-1.304-1.669-2.987-1.457-4.739 0.284-2.335 1.992-4.307 4.204-4.982zM8.985 1c-0.362 0-0.731 0.024-1.104 0.075-3.543 0.48-6.388 3.364-6.82 6.92-0.592 4.867 3.184 9.005 7.924 9.005 0.33 0 0.665-0.020 1.003-0.062 3.549-0.433 6.428-3.283 6.907-6.833 0.052-0.383 0.076-0.761 0.075-1.134-0.002-0.583-0.482-0.972-0.996-0.972-0.209 0-0.424 0.065-0.614 0.207-0.665 0.498-1.489 0.793-2.383 0.793-0.188 0-0.38-0.013-0.574-0.040-1.732-0.242-3.137-1.649-3.378-3.385-0.155-1.115 0.149-2.156 0.751-2.963 0.415-0.657 0.025-1.609-0.764-1.612-0.009 0-0.018 0-0.028 0v0z"></path></symbol> <symbol id="theme-icon-palette" viewBox="0 0 1024 1024"><path d="M745.984 512q25.984 0 45.013333-18.005333t18.986667-45.994667-18.986667-45.994667-45.013333-18.005333-45.013333 18.005333-18.986667 45.994667 18.986667 45.994667 45.013333 18.005333zM617.984 342.016q25.984 0 45.013333-18.986667t18.986667-45.013333-18.986667-45.013333-45.013333-18.986667-45.013333 18.986667-18.986667 45.013333 18.986667 45.013333 45.013333 18.986667zM406.016 342.016q25.984 0 45.013333-18.986667t18.986667-45.013333-18.986667-45.013333-45.013333-18.986667-45.013333 18.986667-18.986667 45.013333 18.986667 45.013333 45.013333 18.986667zM278.016 512q25.984 0 45.013333-18.005333t18.986667-45.994667-18.986667-45.994667-45.013333-18.005333-45.013333 18.005333-18.986667 45.994667 18.986667 45.994667 45.013333 18.005333zM512 128q157.994667 0 271.018667 100.010667t112.981333 242.005333q0 88.021333-63.018667 150.016t-150.997333 61.994667l-73.984 0q-27.989333 0-45.994667 18.986667t-18.005333 45.013333q0 22.016 16 41.984t16 43.989333q0 27.989333-18.005333 45.994667t-45.994667 18.005333q-160 0-272-112t-112-272 112-272 272-112z" p-id="10529"></path></symbol> </svg></div><div class="global-ui"><div class="float-menu-wrap"><!----> <div class="float-menu__list"><span class="icon-up"></span> <span title="auto" class="theme-mode-setting"><svg class="theme-icon theme-icon-auto"><use xlink:href="#theme-icon-auto"></use></svg></span> <!----> <span class="icon-toc"></span> <span class="icon-search"></span></div> <div class="float-menu"><svg width="100%" height="100%" class="float-menu__progress"><circle stroke-dasharray="0% 301.59289474462014%" stroke="currentcolor" stroke-width="2%" fill="none" r="48%" cx="50%" cy="50%"></circle></svg> <div class="float-menu__dot"></div></div></div><div class="theme-search" style="display:none;"><div class="theme-search__inner"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <a class="icon-exit"></a></div></div></div></div>
    <script src="/assets/js/app.68bfad1c.js" defer></script><script src="/assets/js/4.2437bced.js" defer></script><script src="/assets/js/12.a478910c.js" defer></script><script src="/assets/js/49.11a361e1.js" defer></script>
  </body>
</html>